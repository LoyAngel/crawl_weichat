# ÂêéÁ´ØÂÆûÁé∞ËØ¶ÁªÜÊåáÂçó

> Êú¨ÊñáÊ°£ËØ¶ÁªÜÊèèËø∞‰∫ÜÂæÆ‰ø°ÂÖ¨‰ºóÂè∑ÂõæÁâáÁà¨ÂèñÂ∑•ÂÖ∑ÂêéÁ´ØÊúçÂä°ÁöÑÂÆåÊï¥ÂÆûÁé∞ÊñπÊ°àÂíåÂºÄÂèëÊµÅÁ®ã

## üìã È°πÁõÆÊ¶ÇËø∞

Êú¨È°πÁõÆÈááÁî®**ÂâçÂêéÁ´ØÂàÜÁ¶ªÊû∂ÊûÑ**ÔºåÈúÄË¶ÅÂÆûÁé∞‰∏Ä‰∏™Áã¨Á´ãÁöÑ Node.js + Express ÂêéÁ´ØÊúçÂä°ÔºåÁî®‰∫éÂ§ÑÁêÜÂæÆ‰ø°ÂÖ¨‰ºóÂè∑ÊñáÁ´†ÂõæÁâáÁöÑÁà¨Âèñ„ÄÅ‰∏ãËΩΩÂíåÂéãÁº©„ÄÇÂâçÁ´ØÂ∑≤ÂÆåÊàêÂºÄÂèëÔºåAPI Êé•Âè£ËßÑËåÉËØ∑ÂèÇËÄÉ `API_DOCS.md`„ÄÇ

## üèóÔ∏è Êû∂ÊûÑÂÜ≥Á≠ñÔºöÂâçÂêéÁ´ØÂàÜÁ¶ª

### Êé®ËçêÈ°πÁõÆÁªìÊûÑ
```
crawl_weichat/                    # È°πÁõÆÊ†πÁõÆÂΩï
‚îú‚îÄ‚îÄ frontend/                     # ÂâçÁ´ØÈ°πÁõÆ
‚îÇ   ‚îú‚îÄ‚îÄ package.json              # ÂâçÁ´Ø‰æùËµñ
‚îÇ   ‚îú‚îÄ‚îÄ vite.config.ts
‚îÇ   ‚îú‚îÄ‚îÄ src/                      # ÂΩìÂâçÊâÄÊúâÂâçÁ´Ø‰ª£Á†Å
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ backend/                      # ÂêéÁ´ØÈ°πÁõÆ
‚îÇ   ‚îú‚îÄ‚îÄ package.json              # ÂêéÁ´Ø‰æùËµñ
‚îÇ   ‚îú‚îÄ‚îÄ src/                      # ÂêéÁ´ØÊ∫êÁ†Å
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ package.json                  # Ê†πÁ∫ßÂ∑•ÂÖ∑ËÑöÊú¨
‚îú‚îÄ‚îÄ doc/                          # È°πÁõÆÊñáÊ°£
‚îî‚îÄ‚îÄ README.md
```

### ÂàÜÁ¶ªÁöÑ‰ºòÂäø
- **Áã¨Á´ãÈÉ®ÁΩ≤**ÔºöÂâçÂêéÁ´ØÂèØÂàÜÂà´ÈÉ®ÁΩ≤Âà∞‰∏çÂêåÊúçÂä°Âô®
- **‰æùËµñÈöîÁ¶ª**ÔºöÈÅøÂÖçÂâçÁ´ØÊâìÂåÖÂåÖÂê´ÂêéÁ´Ø‰æùËµñ
- **Âõ¢ÈòüÂçè‰Ωú**ÔºöÂâçÂêéÁ´ØÂºÄÂèë‰∫í‰∏çÂπ≤Êâ∞
- **ÊäÄÊúØÊ†àÁã¨Á´ã**Ôºö‰æø‰∫éÂêéÁª≠ÊäÄÊúØÂçáÁ∫ß

## üóÇÔ∏è ÂêéÁ´ØÁõÆÂΩïÁªìÊûÑËßÑÂàí

```
backend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app.ts                 # Express Â∫îÁî®‰∏ªÊñá‰ª∂
‚îÇ   ‚îú‚îÄ‚îÄ server.ts             # ÊúçÂä°Âô®ÂêØÂä®Êñá‰ª∂
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.ts          # ÈÖçÁΩÆÁÆ°ÁêÜ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.ts       # Êï∞ÊçÆÂ∫ìÈÖçÁΩÆÔºàÂèØÈÄâÔºâ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cors.ts           # CORS ÈÖçÁΩÆ
‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ crawlController.ts # Áà¨ÂèñÊéßÂà∂Âô®
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ downloadController.ts # ‰∏ãËΩΩÊéßÂà∂Âô®
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ crawlService.ts   # Áà¨Âèñ‰∏öÂä°ÈÄªËæë
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ downloadService.ts # ‰∏ãËΩΩÊúçÂä°
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ compressionService.ts # ÂéãÁº©ÊúçÂä°
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ taskService.ts    # ‰ªªÂä°ÁÆ°ÁêÜÊúçÂä°
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ htmlParser.ts     # HTML Ëß£ÊûêÂ∑•ÂÖ∑
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ imageDownloader.ts # ÂõæÁâá‰∏ãËΩΩÂ∑•ÂÖ∑
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fileUtils.ts      # Êñá‰ª∂Êìç‰ΩúÂ∑•ÂÖ∑
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validator.ts      # Êï∞ÊçÆÈ™åËØÅÂ∑•ÂÖ∑
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logger.ts         # Êó•ÂøóÂ∑•ÂÖ∑
‚îÇ   ‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task.ts           # ‰ªªÂä°Áõ∏ÂÖ≥Á±ªÂûã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.ts            # API Êé•Âè£Á±ªÂûã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config.ts         # ÈÖçÁΩÆÁ±ªÂûã
‚îÇ   ‚îú‚îÄ‚îÄ middlewares/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ errorHandler.ts   # ÈîôËØØÂ§ÑÁêÜ‰∏≠Èó¥‰ª∂
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ requestLogger.ts  # ËØ∑Ê±ÇÊó•Âøó‰∏≠Èó¥‰ª∂
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ rateLimiter.ts    # ÈôêÊµÅ‰∏≠Èó¥‰ª∂
‚îÇ   ‚îî‚îÄ‚îÄ routes/
‚îÇ       ‚îú‚îÄ‚îÄ index.ts          # Ë∑ØÁî±Ê±áÊÄª
‚îÇ       ‚îú‚îÄ‚îÄ crawl.ts          # Áà¨ÂèñÁõ∏ÂÖ≥Ë∑ØÁî±
‚îÇ       ‚îî‚îÄ‚îÄ download.ts       # ‰∏ãËΩΩÁõ∏ÂÖ≥Ë∑ØÁî±
‚îú‚îÄ‚îÄ downloads/                # ‰∏¥Êó∂‰∏ãËΩΩÁõÆÂΩï
‚îú‚îÄ‚îÄ compressed/               # ÂéãÁº©Êñá‰ª∂Â≠òÂÇ®ÁõÆÂΩï
‚îú‚îÄ‚îÄ logs/                     # Êó•ÂøóÊñá‰ª∂ÁõÆÂΩï
‚îú‚îÄ‚îÄ tests/                    # ÊµãËØïÊñá‰ª∂
‚îú‚îÄ‚îÄ package.json              # ÂêéÁ´Ø‰æùËµñÈÖçÁΩÆ
‚îú‚îÄ‚îÄ tsconfig.json            # TypeScript ÈÖçÁΩÆ
‚îú‚îÄ‚îÄ nodemon.json             # ÂºÄÂèëÁéØÂ¢ÉÈÖçÁΩÆ
‚îî‚îÄ‚îÄ .env.example             # ÁéØÂ¢ÉÂèòÈáèÁ§∫‰æã
```

## üöÄ ÂºÄÂèëÊµÅÁ®ãËØ¶ÁªÜÊ≠•È™§

### Èò∂ÊÆµ 1: È°πÁõÆÂàùÂßãÂåñ (È¢ÑËÆ°Êó∂Èó¥: 1-2Â∞èÊó∂)

#### 1.1 ÂàõÂª∫ÂêéÁ´ØÈ°πÁõÆÁªìÊûÑ
```bash
# Âú®È°πÁõÆÊ†πÁõÆÂΩïÊâßË°å
mkdir backend
cd backend
npm init -y

# ÂêåÊó∂ÈáçÊûÑÂâçÁ´ØÂà∞Áã¨Á´ãÁõÆÂΩïÔºàÂ¶ÇÈúÄË¶ÅÔºâ
# mkdir frontend
# mv ../src ../frontend/
# mv ../package.json ../frontend/
# mv ../vite.config.ts ../frontend/
# ... Á≠âÂâçÁ´ØÊñá‰ª∂
```

#### 1.2 ÂÆâË£ÖÊ†∏ÂøÉ‰æùËµñ
```bash
# Ê†∏ÂøÉÊ°ÜÊû∂Âíå‰∏≠Èó¥‰ª∂
npm install express cors helmet morgan compression
npm install multer body-parser cookie-parser

# Â∑•ÂÖ∑Â∫ì
npm install axios jsdom node-html-parser adm-zip
npm install uuid dayjs fs-extra

# ÂºÄÂèë‰æùËµñ
npm install -D @types/node @types/express @types/cors
npm install -D @types/multer @types/uuid @types/fs-extra
npm install -D typescript nodemon ts-node concurrently
npm install -D @types/morgan @types/compression
```

#### 1.3 ÈÖçÁΩÆ TypeScript
ÂàõÂª∫ `tsconfig.json`Ôºö
```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "commonjs",
    "lib": ["ES2020"],
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "resolveJsonModule": true,
    "declaration": true,
    "declarationMap": true,
    "sourceMap": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist", "tests"]
}
```

#### 1.4 ÈÖçÁΩÆÂºÄÂèëÁéØÂ¢É
ÂàõÂª∫ `nodemon.json`Ôºö
```json
{
  "watch": ["src"],
  "ext": "ts",
  "ignore": ["src/**/*.spec.ts"],
  "exec": "ts-node ./src/server.ts"
}
```

Êõ¥Êñ∞ `package.json` scriptsÔºö
```json
{
  "scripts": {
    "dev": "nodemon",
    "build": "tsc",
    "start": "node dist/server.js",
    "test": "jest",
    "lint": "eslint src/**/*.ts"
  }
}
```

### Ê†πÁõÆÂΩïÂ∑•ÂÖ∑ËÑöÊú¨ÈÖçÁΩÆ

Âú®È°πÁõÆÊ†πÁõÆÂΩïÁöÑ `package.json` ‰∏≠ÈÖçÁΩÆÁÆ°ÁêÜËÑöÊú¨Ôºö
```json
{
  "name": "crawl-weichat-monorepo",
  "private": true,
  "scripts": {
    "dev": "concurrently \"npm run dev:backend\" \"npm run dev:frontend\"",
    "dev:frontend": "cd frontend && npm run dev",
    "dev:backend": "cd backend && npm run dev",
    "build": "npm run build:frontend && npm run build:backend",
    "build:frontend": "cd frontend && npm run build",
    "build:backend": "cd backend && npm run build",
    "install:all": "npm install && cd frontend && npm install && cd ../backend && npm install",
    "test": "npm run test:frontend && npm run test:backend",
    "test:frontend": "cd frontend && npm test",
    "test:backend": "cd backend && npm test",
    "start": "npm run start:backend",
    "start:backend": "cd backend && npm start"
  },
  "devDependencies": {
    "concurrently": "^9.2.0"
  }
}
```

### Èò∂ÊÆµ 2: Âü∫Á°ÄÊû∂ÊûÑÊê≠Âª∫ (È¢ÑËÆ°Êó∂Èó¥: 2-3Â∞èÊó∂)

#### 2.1 ÂàõÂª∫ÈÖçÁΩÆÁÆ°ÁêÜÁ≥ªÁªü
ÂÆûÁé∞ `src/config/index.ts`Ôºö
- ÁéØÂ¢ÉÂèòÈáèÁÆ°ÁêÜ
- Á´ØÂè£ÈÖçÁΩÆ (ÈªòËÆ§ 3000)
- CORS ÈÖçÁΩÆ
- Êñá‰ª∂Â≠òÂÇ®Ë∑ØÂæÑÈÖçÁΩÆ
- ‰ªªÂä°ÈòüÂàóÈÖçÁΩÆ

#### 2.2 Êê≠Âª∫ Express Â∫îÁî®
ÂÆûÁé∞ `src/app.ts`Ôºö
- Express Â∫îÁî®ÂàùÂßãÂåñ
- ‰∏≠Èó¥‰ª∂ÈÖçÁΩÆ (CORS, JSON parser, ÈùôÊÄÅÊñá‰ª∂)
- Ë∑ØÁî±Ê≥®ÂÜå
- ÈîôËØØÂ§ÑÁêÜ‰∏≠Èó¥‰ª∂
- 404 Â§ÑÁêÜ

ÂÆûÁé∞ `src/server.ts`Ôºö
- ÊúçÂä°Âô®ÂêØÂä®ÈÄªËæë
- ‰ºòÈõÖÂÖ≥Èó≠Â§ÑÁêÜ
- Á´ØÂè£ÁõëÂê¨

#### 2.3 ÂÆûÁé∞‰∏≠Èó¥‰ª∂
ÂÆûÁé∞ `src/middlewares/errorHandler.ts`Ôºö
- Áªü‰∏ÄÈîôËØØÂ§ÑÁêÜ
- ÈîôËØØÊó•ÂøóËÆ∞ÂΩï
- Áî®Êà∑ÂèãÂ•ΩÁöÑÈîôËØØÂìçÂ∫î

ÂÆûÁé∞ `src/middlewares/requestLogger.ts`Ôºö
- ËØ∑Ê±ÇÊó•ÂøóËÆ∞ÂΩï
- ÂìçÂ∫îÊó∂Èó¥ÁªüËÆ°

ÂÆûÁé∞ `src/middlewares/rateLimiter.ts`Ôºö
- API ÈôêÊµÅ‰øùÊä§
- Èò≤Ê≠¢Êª•Áî®

#### 2.4 ËÆæÁΩÆÊó•ÂøóÁ≥ªÁªü
ÂÆûÁé∞ `src/utils/logger.ts`Ôºö
- ÂàÜÁ∫ßÊó•ÂøóËÆ∞ÂΩï (debug, info, warn, error)
- Êñá‰ª∂Êó•ÂøóËæìÂá∫
- ÊéßÂà∂Âè∞Êó•ÂøóÊ†ºÂºèÂåñ

### Èò∂ÊÆµ 3: Ê†∏ÂøÉ‰∏öÂä°ÈÄªËæëÂÆûÁé∞ (È¢ÑËÆ°Êó∂Èó¥: 4-6Â∞èÊó∂)

#### 3.1 HTML Ëß£ÊûêÊúçÂä°
ÂÆûÁé∞ `src/utils/htmlParser.ts`Ôºö
- ‰ΩøÁî® `jsdom` Êàñ `node-html-parser` Ëß£ÊûêÂæÆ‰ø°ÊñáÁ´† HTML
- ÊèêÂèñÊñáÁ´†‰∏≠ÁöÑÊâÄÊúâÂõæÁâá URL
- Â§ÑÁêÜ‰∏çÂêåÁöÑÂõæÁâá URL Ê†ºÂºè (Áõ∏ÂØπË∑ØÂæÑ„ÄÅÁªùÂØπË∑ØÂæÑ„ÄÅCDN ÈìæÊé•Á≠â)
- ÂõæÁâá URL ÂéªÈáçÂíåÈ™åËØÅ

**Ê†∏ÂøÉÂÆûÁé∞Á§∫‰æã**Ôºö
```typescript
import { parse } from 'node-html-parser';
import { URL } from 'url';

export class HtmlParser {
  /**
   * ‰ªéHTML‰∏≠ÊèêÂèñÊâÄÊúâÂõæÁâáURL
   */
  static extractImageUrls(html: string, baseUrl: string): string[] {
    const root = parse(html);
    const imgElements = root.querySelectorAll('img');
    
    const imageUrls = imgElements
      .map(img => img.getAttribute('src'))
      .filter(src => src && this.isValidImageUrl(src))
      .map(src => this.resolveUrl(src!, baseUrl))
      .filter((url, index, array) => array.indexOf(url) === index); // ÂéªÈáç
    
    return imageUrls;
  }
  
  private static isValidImageUrl(url: string): boolean {
    const imageExtensions = /\.(jpg|jpeg|png|gif|bmp|webp)(\?.*)?$/i;
    return imageExtensions.test(url) || url.includes('wx_fmt=');
  }
  
  private static resolveUrl(url: string, baseUrl: string): string {
    if (url.startsWith('http')) return url;
    if (url.startsWith('//')) return 'https:' + url;
    return new URL(url, baseUrl).href;
  }
}
```

#### 3.2 ÂõæÁâá‰∏ãËΩΩÊúçÂä°
ÂÆûÁé∞ `src/utils/imageDownloader.ts`Ôºö
- Âπ∂Âèë‰∏ãËΩΩÂõæÁâá (ÊéßÂà∂Âπ∂ÂèëÊï∞ÔºåÂª∫ËÆÆ 5-10)
- ‰∏ãËΩΩËøõÂ∫¶Ë∑üË∏™
- Â§±Ë¥•ÈáçËØïÊú∫Âà∂ (ÊúÄÂ§ö 3 Ê¨°)
- ÂõæÁâáÊ†ºÂºèÈ™åËØÅ
- Êñá‰ª∂Â§ßÂ∞èÈôêÂà∂
- Ë∂ÖÊó∂Â§ÑÁêÜ

**Ê†∏ÂøÉÂÆûÁé∞Á§∫‰æã**Ôºö
```typescript
import axios from 'axios';
import fs from 'fs-extra';
import path from 'path';

export class ImageDownloader {
  private maxConcurrent = 5;
  private retryCount = 3;
  private timeout = 30000;
  
  /**
   * ÊâπÈáè‰∏ãËΩΩÂõæÁâá
   */
  async downloadImages(
    imageUrls: string[], 
    downloadDir: string,
    onProgress: (progress: number) => void
  ): Promise<string[]> {
    const downloadedFiles: string[] = [];
    let completed = 0;
    
    // ÂàÜÊâπÂπ∂Âèë‰∏ãËΩΩ
    for (let i = 0; i < imageUrls.length; i += this.maxConcurrent) {
      const batch = imageUrls.slice(i, i + this.maxConcurrent);
      const promises = batch.map(async (url, index) => {
        try {
          const filename = await this.downloadSingleImage(url, downloadDir);
          if (filename) downloadedFiles.push(filename);
        } catch (error) {
          console.error(`‰∏ãËΩΩÂ§±Ë¥•: ${url}`, error);
        }
        completed++;
        onProgress(Math.round((completed / imageUrls.length) * 100));
      });
      
      await Promise.all(promises);
    }
    
    return downloadedFiles;
  }
  
  private async downloadSingleImage(url: string, dir: string): Promise<string | null> {
    for (let attempt = 0; attempt < this.retryCount; attempt++) {
      try {
        const response = await axios.get(url, {
          responseType: 'stream',
          timeout: this.timeout,
          headers: {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
          }
        });
        
        const filename = this.generateFilename(url);
        const filepath = path.join(dir, filename);
        const writer = fs.createWriteStream(filepath);
        
        response.data.pipe(writer);
        
        return new Promise((resolve, reject) => {
          writer.on('finish', () => resolve(filename));
          writer.on('error', reject);
        });
      } catch (error) {
        if (attempt === this.retryCount - 1) throw error;
        await this.delay(1000 * (attempt + 1)); // ÈÄíÂ¢ûÂª∂Ëøü
      }
    }
    return null;
  }
  
  private generateFilename(url: string): string {
    const urlObj = new URL(url);
    const timestamp = Date.now();
    const extension = path.extname(urlObj.pathname) || '.jpg';
    return `image_${timestamp}_${Math.random().toString(36).substring(7)}${extension}`;
  }
  
  private delay(ms: number): Promise<void> {
    return new Promise(resolve => setTimeout(resolve, ms));
  }
}
```

#### 3.3 Êñá‰ª∂ÂéãÁº©ÊúçÂä°
ÂÆûÁé∞ `src/services/compressionService.ts`Ôºö
- ‰ΩøÁî® `adm-zip` ÂàõÂª∫ ZIP Êñá‰ª∂
- ÂéãÁº©ËøõÂ∫¶Ë∑üË∏™
- ÂéãÁº©Á∫ßÂà´ÈÖçÁΩÆ
- Êñá‰ª∂ÂêçÂéªÈáçÂ§ÑÁêÜ

**Ê†∏ÂøÉÂÆûÁé∞Á§∫‰æã**Ôºö
```typescript
import AdmZip from 'adm-zip';
import fs from 'fs-extra';
import path from 'path';

export class CompressionService {
  /**
   * ÂéãÁº©ÂõæÁâáÊñá‰ª∂
   */
  async compressImages(
    imageFiles: string[],
    sourceDir: string,
    outputPath: string,
    onProgress: (progress: number) => void
  ): Promise<string> {
    const zip = new AdmZip();
    let processed = 0;
    
    for (const filename of imageFiles) {
      const filePath = path.join(sourceDir, filename);
      
      if (await fs.pathExists(filePath)) {
        const buffer = await fs.readFile(filePath);
        zip.addFile(filename, buffer);
      }
      
      processed++;
      onProgress(Math.round((processed / imageFiles.length) * 100));
    }
    
    // ÂÜôÂÖ•ZIPÊñá‰ª∂
    zip.writeZip(outputPath);
    return outputPath;
  }
  
  /**
   * Ëé∑ÂèñÂéãÁº©Êñá‰ª∂‰ø°ÊÅØ
   */
  async getCompressionInfo(zipPath: string) {
    const stats = await fs.stat(zipPath);
    const zip = new AdmZip(zipPath);
    const entries = zip.getEntries();
    
    return {
      fileSize: stats.size,
      fileCount: entries.length,
      createdAt: stats.birthtime
    };
  }
}
```

#### 3.4 ‰ªªÂä°ÁÆ°ÁêÜÊúçÂä°
ÂÆûÁé∞ `src/services/taskService.ts`Ôºö
- ‰ªªÂä°Áä∂ÊÄÅÁÆ°ÁêÜ (pending, downloading, compressing, completed, failed)
- ‰ªªÂä°ÈòüÂàóÂÆûÁé∞
- ‰ªªÂä°ËøõÂ∫¶Êõ¥Êñ∞
- ‰ªªÂä°ÂèñÊ∂àÂ§ÑÁêÜ
- ‰ªªÂä°ÂéÜÂè≤ËÆ∞ÂΩïÁÆ°ÁêÜ

### Èò∂ÊÆµ 4: API Êé•Âè£ÂÆûÁé∞ (È¢ÑËÆ°Êó∂Èó¥: 3-4Â∞èÊó∂)

> ËØ¶ÁªÜÁöÑ API ËßÑËåÉËØ∑ÂèÇËÄÉ `API_DOCS.md` ÊñáÊ°£

#### 4.1 Áà¨ÂèñÊéßÂà∂Âô®
ÂÆûÁé∞ `src/controllers/crawlController.ts`Ôºö

**POST /api/crawl/start**
- ËæìÂÖ•È™åËØÅÔºöÊ£ÄÊü•ÂæÆ‰ø°ÊñáÁ´† URL Ê†ºÂºè
- ÂàõÂª∫Êñ∞‰ªªÂä°ÔºöÁîüÊàêÂîØ‰∏Ä taskId
- ÂºÇÊ≠•Â§ÑÁêÜÔºöÂêØÂä®Áà¨ÂèñÊµÅÁ®ã
- ËøîÂõû‰ªªÂä°‰ø°ÊÅØ

**GET /api/crawl/status/:taskId**
- ‰ªªÂä°Êü•ËØ¢ÔºöÊ†πÊçÆ taskId Ëé∑Âèñ‰ªªÂä°Áä∂ÊÄÅ
- ËøõÂ∫¶‰ø°ÊÅØÔºöËøîÂõû‰∏ãËΩΩÂíåÂéãÁº©ËøõÂ∫¶
- ÈîôËØØÂ§ÑÁêÜÔºö‰ªªÂä°‰∏çÂ≠òÂú®ÁöÑÊÉÖÂÜµ

**POST /api/crawl/cancel/:taskId**
- ‰ªªÂä°ÂèñÊ∂àÔºöÂÅúÊ≠¢Ê≠£Âú®ËøõË°åÁöÑ‰ªªÂä°
- ËµÑÊ∫êÊ∏ÖÁêÜÔºöÂà†Èô§‰∏¥Êó∂Êñá‰ª∂
- Áä∂ÊÄÅÊõ¥Êñ∞ÔºöÊõ¥Êñ∞‰ªªÂä°Áä∂ÊÄÅ‰∏∫Â∑≤ÂèñÊ∂à

**GET /api/crawl/history**
- ÂéÜÂè≤Êü•ËØ¢ÔºöËøîÂõûÊâÄÊúâ‰ªªÂä°ÂéÜÂè≤
- ÂàÜÈ°µÊîØÊåÅÔºöÊîØÊåÅÂàÜÈ°µÊü•ËØ¢
- ÊéíÂ∫èÔºöÊåâÂàõÂª∫Êó∂Èó¥ÂÄíÂ∫è

#### 4.2 ‰∏ãËΩΩÊéßÂà∂Âô®
ÂÆûÁé∞ `src/controllers/downloadController.ts`Ôºö

**GET /download/:filename**
- Êñá‰ª∂È™åËØÅÔºöÊ£ÄÊü•Êñá‰ª∂ÊòØÂê¶Â≠òÂú®
- ÂÆâÂÖ®Ê£ÄÊü•ÔºöÈò≤Ê≠¢Ë∑ØÂæÑÈÅçÂéÜÊîªÂáª
- ÊµÅÂºè‰∏ãËΩΩÔºöÊîØÊåÅÂ§ßÊñá‰ª∂‰∏ãËΩΩ
- ‰∏ãËΩΩÂÆåÊàêÂêéÊ∏ÖÁêÜÔºöÂèØÈÄâÊã©ÊòØÂê¶Âà†Èô§Êñá‰ª∂

### Èò∂ÊÆµ 5: Ê†∏ÂøÉÁà¨ÂèñÊµÅÁ®ãÂÆûÁé∞ (È¢ÑËÆ°Êó∂Èó¥: 4-5Â∞èÊó∂)

#### 5.1 ‰∏ªÁà¨ÂèñÊúçÂä°
ÂÆûÁé∞ `src/services/crawlService.ts`Ôºö

```typescript
async function processCrawlTask(taskId: string, url: string) {
  try {
    // 1. Êõ¥Êñ∞‰ªªÂä°Áä∂ÊÄÅ‰∏∫ downloading
    await updateTaskStatus(taskId, 'downloading');
    
    // 2. Ëé∑ÂèñÊñáÁ´† HTML ÂÜÖÂÆπ
    const htmlContent = await fetchArticleHTML(url);
    
    // 3. Ëß£ÊûêÂπ∂ÊèêÂèñÂõæÁâá URL
    const imageUrls = await parseImageUrls(htmlContent);
    
    // 4. ÂàõÂª∫‰ªªÂä°‰∏ìÁî®‰∏ãËΩΩÁõÆÂΩï
    const downloadDir = await createTaskDirectory(taskId);
    
    // 5. Âπ∂Âèë‰∏ãËΩΩÂõæÁâá
    const downloadedImages = await downloadImages(
      imageUrls, 
      downloadDir, 
      (progress) => updateDownloadProgress(taskId, progress)
    );
    
    // 6. Êõ¥Êñ∞‰ªªÂä°Áä∂ÊÄÅ‰∏∫ compressing
    await updateTaskStatus(taskId, 'compressing');
    
    // 7. ÂéãÁº©ÂõæÁâáÊñá‰ª∂
    const zipPath = await compressImages(
      downloadedImages, 
      taskId,
      (progress) => updateCompressionProgress(taskId, progress)
    );
    
    // 8. Êõ¥Êñ∞‰ªªÂä°Áä∂ÊÄÅ‰∏∫ completed
    await completeTask(taskId, zipPath, downloadedImages.length);
    
    // 9. Ê∏ÖÁêÜ‰∏¥Êó∂Êñá‰ª∂
    await cleanupTempFiles(downloadDir);
    
  } catch (error) {
    // ÈîôËØØÂ§ÑÁêÜÔºöÊõ¥Êñ∞‰ªªÂä°Áä∂ÊÄÅ‰∏∫ failed
    await failTask(taskId, error.message);
    throw error;
  }
}
```

#### 5.2 HTML ÂÜÖÂÆπËé∑Âèñ
- ‰ΩøÁî® `axios` Ëé∑ÂèñÂæÆ‰ø°ÊñáÁ´†È°µÈù¢
- Â§ÑÁêÜÂèØËÉΩÁöÑÂèçÁà¨Êé™ÊñΩ
- ËÆæÁΩÆÂêàÈÄÇÁöÑ User-Agent
- ÈîôËØØÈáçËØïÊú∫Âà∂

#### 5.3 ÂõæÁâá‰∏ãËΩΩÊµÅÁ®ã
- È™åËØÅÂõæÁâá URL ÊúâÊïàÊÄß
- Â§ÑÁêÜ‰∏çÂêåÂüüÂêçÁöÑÂõæÁâá
- ÂÆûÁé∞‰∏ãËΩΩËøõÂ∫¶ÂõûË∞É
- Â§ÑÁêÜ‰∏ãËΩΩÂ§±Ë¥•ÁöÑÂõæÁâá
- ‰øùÂ≠òÂõæÁâáÂà∞Êú¨Âú∞Âπ∂ËÆ∞ÂΩï‰ø°ÊÅØ

#### 5.4 Êñá‰ª∂ÂéãÁº©ÊµÅÁ®ã
- ÂàõÂª∫ ZIP Êñá‰ª∂
- Ê∑ªÂä†ÂõæÁâáÂà∞ÂéãÁº©ÂåÖ
- ÂÆûÁé∞ÂéãÁº©ËøõÂ∫¶ÂõûË∞É
- ÁîüÊàê‰∏ãËΩΩÈìæÊé•

### Èò∂ÊÆµ 6: Ë∑ØÁî±ÂíåÈîôËØØÂ§ÑÁêÜ (È¢ÑËÆ°Êó∂Èó¥: 2-3Â∞èÊó∂)

#### 6.1 Ë∑ØÁî±ÈÖçÁΩÆ
ÂÆûÁé∞ `src/routes/crawl.ts`Ôºö
- ÂÆö‰πâÊâÄÊúâÁà¨ÂèñÁõ∏ÂÖ≥ÁöÑË∑ØÁî±
- ÂèÇÊï∞È™åËØÅ‰∏≠Èó¥‰ª∂
- ÈîôËØØÂ§ÑÁêÜ

ÂÆûÁé∞ `src/routes/download.ts`Ôºö
- Êñá‰ª∂‰∏ãËΩΩË∑ØÁî±
- ÂÆâÂÖ®È™åËØÅ
- ÊµÅÂºè‰º†Ëæì

#### 6.2 Êï∞ÊçÆÈ™åËØÅ
ÂÆûÁé∞ `src/utils/validator.ts`Ôºö
- ÂæÆ‰ø° URL Ê†ºÂºèÈ™åËØÅ
- ËØ∑Ê±ÇÂèÇÊï∞È™åËØÅ
- Êñá‰ª∂ÂÆâÂÖ®Ê£ÄÊü•

#### 6.3 ÈîôËØØÂ§ÑÁêÜÂÆåÂñÑ
- Áªü‰∏ÄÈîôËØØÂìçÂ∫îÊ†ºÂºè
- ‰∏çÂêåÁ±ªÂûãÈîôËØØÁöÑÂ§ÑÁêÜÁ≠ñÁï•
- Áî®Êà∑ÂèãÂ•ΩÁöÑÈîôËØØ‰ø°ÊÅØ

### Èò∂ÊÆµ 7: ÊÄßËÉΩ‰ºòÂåñÂíåÂÆâÂÖ®Âä†Âõ∫ (È¢ÑËÆ°Êó∂Èó¥: 2-3Â∞èÊó∂)

#### 7.1 ÊÄßËÉΩ‰ºòÂåñ
- ÂÆûÁé∞‰∏ãËΩΩÈòüÂàóÈôêÂà∂Âπ∂ÂèëÊï∞
- Ê∑ªÂä†ÁºìÂ≠òÊú∫Âà∂ÔºàÂèØÈÄâÔºâ
- ‰ºòÂåñÊñá‰ª∂ I/O Êìç‰Ωú
- ÂÜÖÂ≠ò‰ΩøÁî®‰ºòÂåñ

#### 7.2 ÂÆâÂÖ®Êé™ÊñΩ
- ËæìÂÖ•È™åËØÅÂíåÊ∏ÖÁêÜ
- Êñá‰ª∂Ë∑ØÂæÑÂÆâÂÖ®Ê£ÄÊü•
- ËØ∑Ê±ÇÈ¢ëÁéáÈôêÂà∂
- Êñá‰ª∂Â§ßÂ∞èÈôêÂà∂

#### 7.3 ËµÑÊ∫êÁÆ°ÁêÜ
- ‰∏¥Êó∂Êñá‰ª∂ÂÆöÊúüÊ∏ÖÁêÜ
- ÂÜÖÂ≠òÊ≥ÑÊºèÈò≤Êä§
- ‰ºòÈõÖÂÖ≥Èó≠Â§ÑÁêÜ

### Èò∂ÊÆµ 8: ÊµãËØïÂíåË∞ÉËØï (È¢ÑËÆ°Êó∂Èó¥: 3-4Â∞èÊó∂)

#### 8.1 ÂçïÂÖÉÊµãËØï
- Â∑•ÂÖ∑ÂáΩÊï∞ÊµãËØï
- ÊúçÂä°Â±ÇÊµãËØï
- ÊéßÂà∂Âô®ÊµãËØï

#### 8.2 ÈõÜÊàêÊµãËØï
- API Á´ØÂà∞Á´ØÊµãËØï
- Êñá‰ª∂Êìç‰ΩúÊµãËØï
- ÈîôËØØÂú∫ÊôØÊµãËØï

#### 8.3 ÊâãÂä®ÊµãËØï
- ÁúüÂÆûÂæÆ‰ø°ÊñáÁ´†ÊµãËØï
- ÂºÇÂ∏∏ÊÉÖÂÜµÊµãËØï
- ÊÄßËÉΩÂéãÂäõÊµãËØï

## üì¶ ‰æùËµñÂåÖËØ¶ÁªÜËØ¥Êòé

### Ê†∏ÂøÉ‰æùËµñ
- **express**: Web Ê°ÜÊû∂
- **cors**: Ë∑®ÂüüËµÑÊ∫êÂÖ±‰∫´
- **axios**: HTTP ÂÆ¢Êà∑Á´ØÔºåÁî®‰∫éËé∑ÂèñÊñáÁ´†ÂÜÖÂÆπ
- **jsdom**: HTML Ëß£ÊûêÔºåÂ§ÑÁêÜ DOM Êìç‰Ωú
- **node-html-parser**: ËΩªÈáèÁ∫ß HTML Ëß£ÊûêÂô®
- **adm-zip**: ZIP Êñá‰ª∂ÂàõÂª∫ÂíåÊìç‰Ωú
- **uuid**: ÁîüÊàêÂîØ‰∏Ä‰ªªÂä° ID
- **fs-extra**: Â¢ûÂº∫ÁöÑÊñá‰ª∂Á≥ªÁªüÊìç‰Ωú

### ÂºÄÂèë‰æùËµñ
- **typescript**: TypeScript ÊîØÊåÅ
- **nodemon**: ÂºÄÂèëÁéØÂ¢ÉÁÉ≠ÈáçËΩΩ
- **@types/***: TypeScript Á±ªÂûãÂÆö‰πâ

## üîß ÈÖçÁΩÆËØ¥Êòé

### ÁéØÂ¢ÉÂèòÈáèÈÖçÁΩÆ
ÂàõÂª∫ `.env` Êñá‰ª∂Ôºö
```env
# ÊúçÂä°Âô®ÈÖçÁΩÆ
PORT=3000
NODE_ENV=development

# Êñá‰ª∂Â≠òÂÇ®ÈÖçÁΩÆ
DOWNLOAD_DIR=./downloads
COMPRESSED_DIR=./compressed
TEMP_DIR=./temp

# ‰∏ãËΩΩÈÖçÁΩÆ
MAX_CONCURRENT_DOWNLOADS=5
DOWNLOAD_TIMEOUT=30000
MAX_FILE_SIZE=10485760

# ‰ªªÂä°ÈÖçÁΩÆ
MAX_CONCURRENT_TASKS=3
TASK_TIMEOUT=300000
AUTO_CLEANUP_HOURS=24
```

### CORS ÈÖçÁΩÆ
ÂÖÅËÆ∏ÂâçÁ´ØÂüüÂêçÁöÑË∑®ÂüüËØ∑Ê±ÇÔºö
```typescript
const corsOptions = {
  origin: [
    'http://localhost:5173', // Vite ÂºÄÂèëÊúçÂä°Âô®
    'http://localhost:4173', // Vite È¢ÑËßàÊúçÂä°Âô®
    // Áîü‰∫ßÁéØÂ¢ÉÂüüÂêç
  ],
  credentials: true
};
```

## üö® Ê≥®ÊÑè‰∫ãÈ°πÂíåÈ£éÈô©ÁÇπ

### 1. ÂæÆ‰ø°ÂèçÁà¨Êú∫Âà∂
- ÂèØËÉΩÈúÄË¶ÅËÆæÁΩÆÂêàÈÄÇÁöÑËØ∑Ê±ÇÂ§¥
- ËÄÉËôëÊ∑ªÂä†ËØ∑Ê±ÇÈó¥Èöî
- ÂáÜÂ§áÂ∫îÂØπ IP ÈôêÂà∂

### 2. ÂõæÁâáËµÑÊ∫êÈóÆÈ¢ò
- Êüê‰∫õÂõæÁâáÂèØËÉΩÈúÄË¶ÅÁâπÊÆäÁöÑËÆøÈóÆÊùÉÈôê
- Â§ÑÁêÜÂõæÁâáÈìæÊé•ÁöÑÊúâÊïàÊúüÈóÆÈ¢ò
- ËÄÉËôëÂõæÁâáÈò≤ÁõóÈìæÊú∫Âà∂

### 3. ÊÄßËÉΩËÄÉËôë
- Â§ßÈáèÂõæÁâá‰∏ãËΩΩÊó∂ÁöÑÂÜÖÂ≠ò‰ΩøÁî®
- Âπ∂ÂèëÊéßÂà∂ÈÅøÂÖçËøáËΩΩ
- Á£ÅÁõòÁ©∫Èó¥ÁÆ°ÁêÜ

### 4. Ê≥ïÂæãÂêàËßÑ
- Á°Æ‰øù‰ΩøÁî®Á¨¶ÂêàÂæÆ‰ø°ÊúçÂä°Êù°Ê¨æ
- ËÄÉËôëÁâàÊùÉÈóÆÈ¢ò
- Ê∑ªÂä†ÈÄÇÂΩìÁöÑÂÖçË¥£Â£∞Êòé

## üìã ÂºÄÂèëÊ£ÄÊü•Ê∏ÖÂçï

### Âü∫Á°ÄÂäüËÉΩ
- [ ] È°πÁõÆÁªìÊûÑÂàõÂª∫
- [ ] ‰æùËµñÂÆâË£ÖÂíåÈÖçÁΩÆ
- [ ] Âü∫Á°Ä Express Â∫îÁî®Êê≠Âª∫
- [ ] ‰∏≠Èó¥‰ª∂ÈÖçÁΩÆ

### Ê†∏ÂøÉÂäüËÉΩ
- [ ] ÂæÆ‰ø°ÊñáÁ´† HTML Ëé∑Âèñ
- [ ] ÂõæÁâá URL Ëß£Êûê
- [ ] ÂõæÁâáÂπ∂Âèë‰∏ãËΩΩ
- [ ] Êñá‰ª∂ÂéãÁº©ÂäüËÉΩ
- [ ] ‰ªªÂä°Áä∂ÊÄÅÁÆ°ÁêÜ

### API Êé•Âè£
- [ ] POST /api/crawl/start
- [ ] GET /api/crawl/status/:taskId
- [ ] POST /api/crawl/cancel/:taskId
- [ ] GET /api/crawl/history
- [ ] GET /download/:filename

### Ë¥®Èáè‰øùËØÅ
- [ ] ÈîôËØØÂ§ÑÁêÜÂÆåÂñÑ
- [ ] Êó•ÂøóËÆ∞ÂΩïÁ≥ªÁªü
- [ ] ËæìÂÖ•È™åËØÅ
- [ ] ÂÆâÂÖ®Êé™ÊñΩ
- [ ] ÂçïÂÖÉÊµãËØï
- [ ] ÈõÜÊàêÊµãËØï

### ÊÄßËÉΩ‰ºòÂåñ
- [ ] Âπ∂ÂèëÊéßÂà∂
- [ ] ÂÜÖÂ≠ò‰ºòÂåñ
- [ ] Êñá‰ª∂Ê∏ÖÁêÜÊú∫Âà∂
- [ ] ÁºìÂ≠òÁ≠ñÁï•ÔºàÂèØÈÄâÔºâ

## üîó Áõ∏ÂÖ≥ÊñáÊ°£

- `API_DOCS.md` - ËØ¶ÁªÜÁöÑ API Êé•Âè£ÊñáÊ°£
- `PROJECT_SUMMARY.md` - È°πÁõÆÊÄª‰Ωì‰ªãÁªçÂíåÂâçÁ´ØÂäüËÉΩËØ¥Êòé
- ÂâçÁ´Ø‰ª£Á†Å `src/api/types.ts` - TypeScript Á±ªÂûãÂÆö‰πâÂèÇËÄÉ

## üìà ÂêéÁª≠Êâ©Â±ïÂª∫ËÆÆ

1. **Êï∞ÊçÆÂ∫ìÈõÜÊàê**: ‰ΩøÁî® SQLite Êàñ MongoDB ÊåÅ‰πÖÂåñ‰ªªÂä°Êï∞ÊçÆ
2. **‰ªªÂä°ÈòüÂàó**: ‰ΩøÁî® Redis Êàñ Bull ÂÆûÁé∞Êõ¥robustÁöÑ‰ªªÂä°ÈòüÂàó
3. **ÁºìÂ≠òÂ±Ç**: Ê∑ªÂä† Redis ÁºìÂ≠òÊèêÈ´òÊÄßËÉΩ
4. **ÁõëÊéßÁ≥ªÁªü**: ÈõÜÊàê APM Â∑•ÂÖ∑ÁõëÊéßÊúçÂä°Áä∂ÊÄÅ
5. **ÂÆπÂô®Âåñ**: Ê∑ªÂä† Docker ÈÖçÁΩÆ‰æø‰∫éÈÉ®ÁΩ≤
6. **API ÊñáÊ°£**: ‰ΩøÁî® Swagger ÁîüÊàê‰∫§‰∫íÂºè API ÊñáÊ°£

---

*È¢ÑËÆ°ÊÄªÂºÄÂèëÊó∂Èó¥: 20-30 Â∞èÊó∂*
*Âª∫ËÆÆÂàÜÈò∂ÊÆµÂÆûÁé∞ÔºåÂÖàÂÆåÊàêÊ†∏ÂøÉÂäüËÉΩÂÜçÈÄêÊ≠•‰ºòÂåñ*
